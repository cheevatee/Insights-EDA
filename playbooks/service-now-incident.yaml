- name: Create an Incident
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Dump incoming vars
      debug:
        msg:
          - "application={{ ansible_eda.event.payload.application | default('MISSING') }}"
          - "account_id={{ ansible_eda.event.payload.account_id | default('MISSING') }}"
          - "event_type={{ ansible_eda.event.payload.event_type | default('MISSING') }}"
          - "bundle={{ ansible_eda.event.payload.bundle | default('MISSING') }}"
#    - name: Create the incident
#      servicenow.itsm.incident:
#        instance:
#          host: "{{ sn_instance }}"
#          username: "{{ sn_user }}"
#          password: "{{ sn_password }}"
#        state: new
#        short_description: "{{ payload.application | upper | default('') }}"
#        description: |-
#          impact: low
#          urgency: low
#          Account id: "{{ account_id | default('') }}"
#          Affected system: "{{ context.display_name | default('') }}"
#          Event type: "{{ event_type | default('') }}"
#          Bundle: "{{ bundle | default('') }}"
#          Created at: "{{ timestamp | default('') }}"
